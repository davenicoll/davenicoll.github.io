<?xml version="1.0" encoding="UTF-8"?><rss xmlns:dc="http://purl.org/dc/elements/1.1/" xmlns:content="http://purl.org/rss/1.0/modules/content/" xmlns:atom="http://www.w3.org/2005/Atom" version="2.0" xmlns:media="http://search.yahoo.com/mrss/"><channel><title><![CDATA[davenicoll.com]]></title><description><![CDATA[The secret underground laboratory of Dave Nicoll, and co.]]></description><link>https://davenicoll.com/</link><image><url>https://davenicoll.com/favicon.png</url><title>davenicoll.com</title><link>https://davenicoll.com/</link></image><generator>Ghost 5.46</generator><lastBuildDate>Thu, 03 Aug 2023 18:05:21 GMT</lastBuildDate><atom:link href="https://davenicoll.com/rss/" rel="self" type="application/rss+xml"/><ttl>60</ttl><item><title><![CDATA[Upgrading my home NAS]]></title><description><![CDATA[<p>I&apos;ve been running various NAS devices for over a decade now. I started doing this because I always had PCs lying around, whether it was my last-gen desktop PC, or some old system I&apos;d acquired from work. I think NAS&apos;s in the home are</p>]]></description><link>https://davenicoll.com/upgrading-my-home-nas/</link><guid isPermaLink="false">64cbd4c3137c8800016c14bf</guid><category><![CDATA[nas]]></category><dc:creator><![CDATA[Dave Nicoll]]></dc:creator><pubDate>Thu, 03 Aug 2023 17:21:01 GMT</pubDate><content:encoded><![CDATA[<p>I&apos;ve been running various NAS devices for over a decade now. I started doing this because I always had PCs lying around, whether it was my last-gen desktop PC, or some old system I&apos;d acquired from work. I think NAS&apos;s in the home are underrated, as they&apos;re so helpful for various projects. Whether it&apos;s providing fast access to family videos for editing, storing your favourite TV &amp; movies to stream to devices, or just needing somewhere safe for all your backups.</p><p>When I moved from the UK to Canada in 2021, I downsized from several Dell PowerEdge 720s, uploaded my data to GSuite Business (thanks to Google ignoring storage capacity limits for several years), and took a single 16TB disk with me on my travels. When I arrived in Canada, I wanted a low-maintenance NAS, with the ability to run containers, stream and transcode media, and was small enough to be moved easily. Having used Synology products before, I bought a <a href="https://www.storagereview.com/review/synology-diskstation-ds720-review?ref=localhost">Synology DiskStation DS720+</a>, added a second 16TB NAS disk, increased the memory with an 8GB RAM module, and installed 2xM.2 drives for caching.</p><p>While Synology hardware may not be anything extraordinary, their software is top-notch. OpenMediaVault, EasyNAS, FreeNAS/TrueNAS, Proxmox, Unraid, Windows(!) - I&apos;ve operated them all, and nobody in the homelab/prosumer market comes close to the simplicity, capability, or app ecosystem that Synology has created with <a href="https://www.synology.com/en-ca/dsm?ref=localhost">DiskStation Manager</a> (DSM). If you&apos;re reading this guide, and you&apos;re interested in a NAS, but building one looks like too much effort, <a href="https://www.synology.com/en-ca/products?product_line=ds_plus&amp;ref=localhost">go buy a Synology</a>.</p><p>Life was good! Until the day Google emailed and informed me they were <a href="https://www.reddit.com/r/DataHoarder/comments/13kr75h/google_enforcing_storage_limit_on_old_gsuite/?ref=localhost">starting to enforce storage capacity limits in my GSuite account</a>. I had 30 days to meet the paltry limit or pay a hefty monthly cost. So, after doing some math[s], I figured, &quot;why not buy a new NAS, increase my local storage capacity, and reduce my cloud spend&quot;.</p><h3 id="requirements">Requirements</h3><p>Build vs Buy is always a factor when choosing technology, and I was leaning towards another, larger Synology. Apart from the lack of bays, the biggest disappointment of the DS720+ was the 2x 1GbE ports. My inner nerd was calling, I could build something better, faster, cheaper, so I made a list of my requirements:</p><ul><li>Small form factor</li><li>Passively-cooled CPU, or very quiet fans for near-silent operation</li><li>Capacity for 5 drives</li><li>Enough CPU/GPU for media transcoding</li><li>Power efficient</li></ul><h3 id="motherboard-and-cpu">Motherboard and CPU</h3><p>I first heard about the <a href="https://www.aliexpress.com/item/1005004878607032.html?ref=localhost">Topton N5105 &quot;NAS&quot; motherboard</a> on Reddit. The reviews were generally positive, and the specs looked to be a great fit for my requirements. Searching for &quot;N5105 NAS motherboard&quot; on Aliexpress results in several variations. I eventually bought the <a href="https://www.aliexpress.com/item/1005005239181127.html?ref=localhost">BKHD version</a>, with these specs:</p><ul><li>Integrated <a href="https://www.intel.com/content/www/us/en/products/sku/212328/intel-celeron-processor-n5105-4m-cache-up-to-2-90-ghz/specifications.html?ref=localhost">Intel Celeron N5105</a> (Jasper Lake) CPU 2Ghz TDP 10W</li><li>1x M.2 NVMe (PCIe 3.0 x1) 2280</li><li>6x SATA 3.0 ports</li><li>4x Intel i226-V 2.5Gbps network interfaces</li><li>2x SO-DIMM DDR4 (2933Mhz) slots, 64GB max</li><li>1x PCI-E slot</li><li>HDMI and Display Port</li><li>Onboard sound</li><li>Mini-ITX form factor</li></ul><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://davenicoll.com/content/images/2023/08/image.png" class="kg-image" alt loading="lazy" width="2000" height="2000" srcset="https://davenicoll.com/content/images/size/w600/2023/08/image.png 600w, https://davenicoll.com/content/images/size/w1000/2023/08/image.png 1000w, https://davenicoll.com/content/images/size/w1600/2023/08/image.png 1600w, https://davenicoll.com/content/images/size/w2400/2023/08/image.png 2400w" sizes="(min-width: 720px) 720px"><figcaption>BKHD N5105 motherboard</figcaption></figure><p>The board is PERFECT for my needs, especially as the Celeron N5105 has an Intel UHD i915 GPU with video encoding/decoding built-in. For the price (CAD$189/US$140/GBP&#xA3;110), the board is excellent value too. (I did consider the Celeron J6412, but its newer chipset is less well-supported and, in several ways, a weaker version of the N5105). Shipping took a month thanks to a delay at customs, but BKHD customer support was helpful and responsive.</p><h3 id="case-and-power-supply">Case and power supply</h3><p>Good NAS cases can be hard to come by, and I&apos;m not sure where it&apos;s due to the pandemic, but I had a tough time finding one at the right price point. But, I did! A coworker recommended a <a href="https://www.jonsbo.com/en/products/N1.html?ref=localhost">Jonsbo N1</a>, and while it looked great from the outside, it was a mess internally and he admitted that putting all together had been a delicate affair. Then I noticed the <a href="https://www.jonsbo.com/en/products/N2Black.html?ref=localhost">Jonsbo N2</a> on their website. ITX form factor? Check! 5+1 bays? Check! Priced sensibly? Check!</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://davenicoll.com/content/images/2023/08/image-3.png" class="kg-image" alt loading="lazy" width="1600" height="800" srcset="https://davenicoll.com/content/images/size/w600/2023/08/image-3.png 600w, https://davenicoll.com/content/images/size/w1000/2023/08/image-3.png 1000w, https://davenicoll.com/content/images/2023/08/image-3.png 1600w" sizes="(min-width: 720px) 720px"><figcaption>Jonsbo N2 case</figcaption></figure><p>I paired the Jonsbo N2 with a <a href="https://www.corsair.com/ca/en/p/psu/cp-9020186-na/sf-series-sf750-750-watt-80-plus-platinum-certified-high-performance-sfx-psu-cp-9020186-na?ref=localhost">Corsair SF750</a> modular PSU which fits snuggly and has all the necessary connections. While the case has a front-panel with cables for USB-C and audio, the motherboard doesn&apos;t have the corresponding headers, so I zip-tied the cables out of the way. Right-angle connectors on the SATA cables were essential, as it&apos;s a tight fit between the drive backplane and the rear fan. Speaking of the rear fan (a generic 120x15 fan), it was louder than I could tolerate - so I replaced it with the <a href="https://noctua.at/en/nf-a12x15-pwm?ref=localhost">Noctua equivalent</a>, and now I can barely hear it all.</p><h3 id="ram">RAM</h3><p>The N5105 motherboard has two DDR4 SO-DIMM slots, which I maxed out with <a href="https://www.crucial.com/memory/ddr4/ct2k32g4sfd832a?ref=localhost">64GB non-ECC 3200Mhz RAM from Crucial</a>. Yes, it&apos;s non-ECC, not ideal, but I have other mitigations to avoid data corruption.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://davenicoll.com/content/images/2023/08/image-4.png" class="kg-image" alt loading="lazy" width="1024" height="537" srcset="https://davenicoll.com/content/images/size/w600/2023/08/image-4.png 600w, https://davenicoll.com/content/images/size/w1000/2023/08/image-4.png 1000w, https://davenicoll.com/content/images/2023/08/image-4.png 1024w" sizes="(min-width: 720px) 720px"><figcaption>Crucial 64GB 3200Mhz DDR4 SO-DIMM memory modules</figcaption></figure><h3 id="storage">Storage</h3><p>There&apos;s two types of storage in my NAS; the boot drive and data storage drives. I installed a 1TB NVMe drive as my boot drive, partitioned into a 64GB boot partition with TrueNAS SCALE installed, and the remaining space for apps, swap, etc. 1TB was probably overkill, but I had one spare from a previous project.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://davenicoll.com/content/images/2023/08/ironwolfpro.png" class="kg-image" alt loading="lazy" width="2000" height="1364" srcset="https://davenicoll.com/content/images/size/w600/2023/08/ironwolfpro.png 600w, https://davenicoll.com/content/images/size/w1000/2023/08/ironwolfpro.png 1000w, https://davenicoll.com/content/images/size/w1600/2023/08/ironwolfpro.png 1600w, https://davenicoll.com/content/images/2023/08/ironwolfpro.png 2200w" sizes="(min-width: 720px) 720px"><figcaption>IronWolf Pro 16TB HDD</figcaption></figure><p>I already had 3x <a href="https://www.seagate.com/www-content/datasheets/pdfs/ironwolf-pro-16tb-DS1914-10-1905US-en_US.pdf?ref=localhost">IronWolf Pro 16TB HDDs</a> for data storage, so I configured two to be mirrored (the data I care about) and one as a standalone stripe (for the data I don&apos;t). Would I recommend the IronWolf Pro disks? <a href="https://realhardwarereviews.com/seagate-ironwolf-pro-16tb-review/?ref=localhost">Absolutely</a>. They&apos;re performant and reliable, have a great warranty backed by a data recovery option, and are priced reasonably now that we&apos;re past the worst of Covid. </p><h3 id="truenas-scale">TrueNAS SCALE</h3><p>My biggest concern was moving away from Synology DSM. Having previously run <a href="https://www.truenas.com/truenas-core/?ref=localhost">TrueNAS Core</a> (FreeNAS), I know it&apos;s a solid NAS OS, but it&apos;s no DSM. I was also never that fond of FreeBSD and jails in TrueNAS Core. My interest was immediately piqued when I heard about <a href="https://www.truenas.com/truenas-scale/?ref=localhost">TrueNAS SCALE</a>, a new offering based on Debian with K3s (or Docker, if you prefer). </p><p>In my opinion, TrueNAS SCALE is a great option, and while there&apos;s certainly a learning curve the first time around, once running, it&apos;s pretty close to DSM in terms of ease of use.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://davenicoll.com/content/images/2023/08/image-9.png" class="kg-image" alt loading="lazy" width="1000" height="452" srcset="https://davenicoll.com/content/images/size/w600/2023/08/image-9.png 600w, https://davenicoll.com/content/images/2023/08/image-9.png 1000w" sizes="(min-width: 720px) 720px"><figcaption>TrueNAS SCALE dashboard</figcaption></figure><p>I partitioned the NVMe boot drive, installed TrueNAS SCALE, setup my disk pools, vdevs, and sharing services. When I installed Plex though, I discovered something concerning. Despite configuring the Plex container with my PlexPass and enabling GPU support, playback of transcoded videos maxed out the CPU. Googling around, I discovered that the Linux kernel version in TrueNAS SCALE doesn&apos;t support the i915 GPU. Thankfully, Intel has backported the driver, <a href="https://gist.github.com/davenicoll/d54f155d0d0e8af427d7763cc5c425c9?ref=localhost">so I cloned the repo, built it and installed it</a>. A reboot later, and the GPU was handling transcoding with ease.</p><figure class="kg-card kg-image-card kg-card-hascaption"><img src="https://davenicoll.com/content/images/2023/08/image-10.png" class="kg-image" alt loading="lazy" width="1024" height="566" srcset="https://davenicoll.com/content/images/size/w600/2023/08/image-10.png 600w, https://davenicoll.com/content/images/size/w1000/2023/08/image-10.png 1000w, https://davenicoll.com/content/images/2023/08/image-10.png 1024w" sizes="(min-width: 720px) 720px"><figcaption>TrueNAS SCALE apps</figcaption></figure><h3 id="what-do-i-think-of-the-nas">What do I think of the NAS?</h3><p>It&apos;s exactly what I set out to build; a power-efficient, fast, easy-to-use NAS with plenty of options to expand storage. </p><p>The case has been a joy to work with, and I&apos;d use it again for a different mini build (with a quieter fan, of course). It saturates my home network, and I love working with it for video editing. With an embedded CPU on the motherboard, I won&apos;t be upgrading it, but that&apos;s not an issue for me. I expect I&apos;ll get at least 3-4 years of use from this NAS, maybe longer, who knows.</p><p>Lastly, this build was not expensive! The N5105 motherboard is an absolute bargain. If you&apos;re buying disks, I&apos;d recommend the IronWolf Pro, but <a href="https://diskprices.com/?ref=localhost">there are cheaper options out there</a> if you were looking to reduce cost.</p>]]></content:encoded></item><item><title><![CDATA[How to ask for help]]></title><description><![CDATA[<p>Scott does something <em>amazing</em>. When he&#x2019;s stuck, or runs into a problem that he needs help with, he posts a message in a group Slack. </p><p>It starts off with the <strong><em>Backstory</em></strong> to give the reader some context and insight into the issue. Then he documents the <strong><em>Problem</em></strong>, and</p>]]></description><link>https://davenicoll.com/how-to-ask-for-help/</link><guid isPermaLink="false">6487fb4b527a55000176e6f2</guid><dc:creator><![CDATA[Dave Nicoll]]></dc:creator><pubDate>Tue, 13 Jun 2023 05:23:59 GMT</pubDate><content:encoded><![CDATA[<p>Scott does something <em>amazing</em>. When he&#x2019;s stuck, or runs into a problem that he needs help with, he posts a message in a group Slack. </p><p>It starts off with the <strong><em>Backstory</em></strong> to give the reader some context and insight into the issue. Then he documents the <strong><em>Problem</em></strong>, and includes any errors (in case the reader recognizes the error, or wants to google it from themselves). Finally he posts some<strong><em> Code</em></strong> snippets to show his work, helping the reader to understand exactly what&#x2019;s being run. </p><p>Not only does this help me, to help Scott better, it&#x2019;s more searchable in Slack for others if they run into similar problems. </p><p>So the next time you need help, please, be more Scott Houglum.</p><hr><p>Here&apos;s an example:</p><blockquote>Hey Dave, I&apos;m wanting to add cors_rules to a storage account. &#xA0;I am assuming since we&apos;ll have different amounts of rules per storage account depending on environment that a dynamic block is best here...</blockquote><p>main.tf</p><pre><code class="language-hcl">blob_properties {
    dynamic &quot;cors_rule&quot; {
      for_each  = lookup(var.blob_cors_rule, terraform.workspace)
      allowed_origins = cors_rule.value[&quot;allowed_origins&quot;]
      allowed_methods = cors_rule.value[&quot;allowed_methods&quot;]
      allowed_headers = cors_rule.value[&quot;allowed_headers&quot;]
      exposed_headers = cors_rule.value[&quot;exposed_headers&quot;]
      max_age_in_seconds = cors_rule.value[&quot;max_age_in_seconds&quot;]
    }
  }</code></pre><p>var.tf</p><pre><code class="language-hcl">variable &quot;blob_cors_rule&quot; {
  type = map(object({
    allowed_headers    = string
    allowed_methods    = string
    allowed_origins    = string
    exposed_headers    = string
    max_age_in_seconds = number
  }))
  default = null
}</code></pre><p>wus2.tfvars</p><pre><code class="language-hcl">blob_cors_rule = {
  dev = [{
    allowed_origins = [&quot;http://localhost:3000&quot;]
    allowed_methods = [&quot;GET&quot;]
    allowed_headers = [&quot;Access-Control-Allow-Origin&quot;]
    exposed_headers = [&quot;*&quot;]
    max_age_in_seconds = 3600
  },
  {
    allowed_origins = [&quot;https://www.someurl.com&quot;]
    allowed_methods = [&quot;GET&quot;]
    allowed_headers = [&quot;Access-Control-Allow-Origin&quot;]
    exposed_headers = [&quot;*&quot;]
    max_age_in_seconds = 3600
  }],
  qa = [{
    allowed_origins = [&quot;http://localhost:3000&quot;]
    allowed_methods = [&quot;GET&quot;]
    allowed_headers = [&quot;Access-Control-Allow-Origin&quot;]
    exposed_headers = [&quot;*&quot;]
    max_age_in_seconds = 3600
  },
  {
    allowed_origins = [&quot;https://www.someurl.com&quot;]
    allowed_methods = [&quot;GET&quot;]
    allowed_headers = [&quot;Access-Control-Allow-Origin&quot;]
    exposed_headers = [&quot;*&quot;]
    max_age_in_seconds = 3600
  }]</code></pre><blockquote>unfortunately I&apos;m getting these errors for all items...</blockquote><pre><code class="language-bash">&#x2502; Error: Unsupported argument
&#x2502;
&#x2502;   on main.tf line 224, in resource &quot;azurerm_storage_account&quot; &quot;storage_account&quot;:
&#x2502;  224:       max_age_in_seconds = var.blob_cors_rule.value[&quot;max_age_in_seconds&quot;]
&#x2502;
&#x2502; An argument named &quot;max_age_in_seconds&quot; is not expected here.</code></pre><blockquote>Thanks</blockquote>]]></content:encoded></item><item><title><![CDATA[Vellum 2022]]></title><description><![CDATA[<p>This is my vellum to you. Thank you for being part of my life this year. Thank you for the laughs, the tears, the code, the support, and the good times. Thank you for being you. I hope you and your family have a wonderful holiday, and an excellent 2023.</p>]]></description><link>https://davenicoll.com/vellum-2022/</link><guid isPermaLink="false">6392806759af090001aad1dc</guid><dc:creator><![CDATA[Dave Nicoll]]></dc:creator><pubDate>Fri, 09 Dec 2022 00:39:08 GMT</pubDate><content:encoded><![CDATA[<p>This is my vellum to you. Thank you for being part of my life this year. Thank you for the laughs, the tears, the code, the support, and the good times. Thank you for being you. I hope you and your family have a wonderful holiday, and an excellent 2023.</p><p>I&apos;ve created a little game for you. It&apos;s meant to be challenging. Play on your own, with a friend or colleague, or as a group... hope you have fun!</p><p>Now, don&apos;t be a slacker, go find the next clue &#x30C4;</p>]]></content:encoded></item></channel></rss>